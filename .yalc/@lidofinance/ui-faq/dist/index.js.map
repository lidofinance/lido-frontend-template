{"mappings":"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","sources":["packages/ui/faq/src/index.ts","packages/ui/faq/src/components/index.ts","packages/ui/faq/src/components/faqAccordion/index.tsx","packages/ui/faq/src/components/faqAccordion/faqAccordion.tsx","packages/ui/faq/src/components/faqAccordion/styles.tsx","packages/ui/faq/styledComponentsWrapper.ts","packages/ui/faq/src/components/faqAccordion/types.ts","packages/ui/faq/src/utils/index.ts","packages/ui/faq/src/utils/remarkPlugins/index.ts","packages/ui/faq/src/utils/remarkPlugins/getFrontmatter.ts","packages/ui/faq/src/utils/remarkPlugins/type.ts"],"sourcesContent":["export * from './components'\nexport * from './utils'\n","export * from './faqAccordion'\n","export * from './faqAccordion'\nexport * from './styles'\nexport * from './types'\n","import React, { FC, ReactNode } from 'react'\nimport ReactMarkdown from 'react-markdown'\nimport { MatomoEventType, trackEvent } from '@lidofinance/analytics-matomo'\nimport { LidoLink } from '@lidofinance/next-ui-primitives'\nimport * as LidoUI from '@lidofinance/lido-ui'\nconst { Accordion } = LidoUI\n\nimport { FAQAccordionProps } from './types'\nimport { FaqItem } from './styles'\n\nconst AnchorWithMatomo = (\n  children: ReactNode | ReactNode[],\n  href: string | undefined,\n  matomoEvent: MatomoEventType | undefined,\n) => {\n  return (\n    <LidoLink\n      href={href ?? '#'}\n      onClick={() => {\n        if (matomoEvent) {\n          trackEvent(...matomoEvent)\n        }\n      }}\n    >\n      {children}\n    </LidoLink>\n  )\n}\n\nexport const FaqAccordion: FC<FAQAccordionProps> = ({ faqList, matomoEventMap }) => {\n  return (\n    <>\n      {faqList.map(({ question, answer }, index) => (\n        <Accordion key={question} defaultExpanded={index === 0} summary={String(question)}>\n          <FaqItem>\n            <ReactMarkdown\n              components={{\n                // @ts-expect-error `a` is like in docs https://github.com/remarkjs/react-markdown#appendix-b-components\n                a: ({ children, href }) => {\n                  let matomoEvent: MatomoEventType | undefined\n\n                  if (matomoEventMap && href) {\n                    matomoEvent = matomoEventMap.get(href)\n                    return AnchorWithMatomo(children, href, matomoEvent)\n                  }\n\n                  // https://github.com/remarkjs/react-markdown#appendix-b-components\n                  return 'a'\n                },\n              }}\n            >\n              {answer}\n            </ReactMarkdown>\n          </FaqItem>\n        </Accordion>\n      ))}\n    </>\n  )\n}\n","import styled from '../../../styledComponentsWrapper'\n\nexport const FaqItem = styled.div`\n  p {\n    margin: 0 0 1.6em;\n  }\n\n  p + ul,\n  p + ol,\n  ul + p,\n  ol + p {\n    margin-top: -1.6em;\n  }\n\n  ul > li,\n  ol > li {\n    margin-top: 0;\n    margin-bottom: 0;\n\n    & > p {\n      margin-top: 0;\n      margin-bottom: 0;\n    }\n  }\n\n  a {\n    text-decoration: none;\n  }\n`\n","// Styled Components v5 has issues with ESM modules:\n// https://github.com/styled-components/styled-components/issues/115\n// https://github.com/rollup/rollup/issues/4438\n// It can be solved by using Styled Components v6, which is in beta ATM\n// But it will be better to stop using styled-components at all.\n// This is a temporary workaround, which seems to work well.\n\nimport _styled, { StyledInterface } from 'styled-components'\n\n// @ts-expect-error Property 'default' does not exist on type 'StyledInterface'.\nconst styled: StyledInterface = _styled.default || _styled\n\nexport * from 'styled-components'\nexport default styled\n","import { MatomoEventType } from '@lidofinance/analytics-matomo'\n\nexport type FAQItem = {\n  answer: string\n  question: string\n}\n\nexport type FAQAccordionProps = {\n  faqList: FAQItem[]\n  matomoEventMap?: Map<string, MatomoEventType> | undefined\n}\n\nexport const isFAQItem = (obj: any): obj is FAQItem => {\n  return 'answer' in obj && 'question' in obj\n}\n\nexport const isFAQAccordionProps = (obj: any): obj is FAQAccordionProps => {\n  return 'faqList' in obj && obj.faqList.isArray()\n}\n","// eslint-disable-next-line import/no-extraneous-dependencies\nimport axios, { Axios } from 'axios'\n// eslint-disable-next-line import/no-extraneous-dependencies\nimport { caching, MemoryCache, MemoryConfig } from 'cache-manager'\nimport { unified, PluggableList } from 'unified'\nimport remarkParse from 'remark-parse'\nimport remarkStringify from 'remark-stringify'\nimport remarkFrontmatter from 'remark-frontmatter'\nimport remarkDirective from 'remark-directive'\n\nimport { FAQItem } from '../components'\nimport { getFrontmatter } from './remarkPlugins'\n\nconst ttlMs = 6 * 100 * 1000 /* 10 minutes */\nconst memoryCacheConfigDefault = { max: 100, ttl: ttlMs }\nlet memoryCache: MemoryCache\n\nconst getMemoryCacheInstance = async (memoryCacheConfig: MemoryConfig = memoryCacheConfigDefault) => {\n  if (!memoryCache) {\n    memoryCache = await caching('memory', memoryCacheConfig)\n  }\n\n  return memoryCache\n}\n\nexport const parseYamlFileWithMdContent = async (\n  md: string,\n  remarkPlugins?: PluggableList,\n): Promise<{ content: string; data: Record<string, any> }> => {\n  const file = await unified()\n    .use(remarkParse)\n    .use(remarkStringify)\n    .use(remarkPlugins || [])\n    .process(md)\n\n  return { content: String(file), data: file.data }\n}\n\nexport type PageFAQ = { identification: string; faq: FAQItem[] }\n\nexport const isPageFAQ = (obj: any): obj is PageFAQ => {\n  return 'identification' in obj && 'faq' in obj\n}\n\nexport type GetFaqOptionsProps = {\n  axiosInstance: Axios\n  cache?: boolean\n  memoryCacheConfig?: MemoryConfig | undefined\n}\n\nconst faqOptionsDefault: GetFaqOptionsProps = { axiosInstance: axios, cache: true }\n\nexport const getFAQ = async (\n  faqUrl: string,\n  { axiosInstance, cache, memoryCacheConfig } = faqOptionsDefault,\n): Promise<PageFAQ[]> => {\n  let memoryCacheInstance: MemoryCache | undefined\n  let rawFaqData: string | undefined\n\n  if (cache) {\n    memoryCacheInstance = await getMemoryCacheInstance(memoryCacheConfig)\n    rawFaqData = await memoryCacheInstance.get(faqUrl)\n  }\n\n  if (!rawFaqData) {\n    rawFaqData = (await axiosInstance.get(faqUrl)).data as string\n\n    if (cache && memoryCacheInstance) {\n      await memoryCacheInstance.set(faqUrl, rawFaqData, ttlMs)\n    }\n  }\n\n  // Temporary solution\n  // The CMS, while generating md, adds an '\\_' between the text and\n  // the link, which is then replaced by 'nbsp;' (non-breaking space)\n  // and interferes correct content display\n  // To fix this, we replace '\\_' with ' '\n  const fixedFileContent = rawFaqData.replace(/\\\\_\\[/gm, ' [').replace(/\\)\\\\_/gm, ') ')\n\n  const { data } = await parseYamlFileWithMdContent(fixedFileContent, [\n    remarkDirective,\n    [remarkFrontmatter, ['yaml']],\n    getFrontmatter,\n  ])\n  const { frontmatter = {} } = data\n  const { pages = [] } = frontmatter\n  return pages\n}\n","export * from './getFrontmatter'\nexport * from './type'\n","import yaml from 'js-yaml'\n\nimport { Tree, VFileWithOutput } from './type'\n\n// eslint-disable-next-line unicorn/consistent-function-scoping\nexport const getFrontmatter = () => (tree: Tree, file: VFileWithOutput<null>) => {\n  const node = tree.children[0]\n\n  if (node?.type === 'yaml') {\n    const data = yaml.load(node.value)\n    file.data.frontmatter = data\n    tree.children.splice(0, 1)\n  } else {\n    file.data.frontmatter = {}\n  }\n}\n","import { Root, Parent, Content } from 'mdast'\nimport { VFileWithOutput } from 'unified'\n\nexport type Tree = Root\n\nexport type Node = Parent\n\nexport type { Content, VFileWithOutput }\n"],"names":[],"version":3,"file":"index.js.map"}